---
title: "R Notebook"
output: html_notebook
---

```{r packages}
#Pacman package loader and useful packages 
if (!require("pacman")) install.packages("pacman"); library(pacman) #helps to load packages more efficiently 
p_unload('all')
pacman::p_load(BiocManager, ggh4x, DT, openxlsx, readxl, rstatix, ggpubr, janitor,ggstatsplot, tidyverse, nortest,broom,svglite,dlookr,ggpattern,plotrix)
```


```{r list}
folder<-"C:/Users/jhdiaz/Desktop/Lab stuff/GI Data_1/Gamma-H2AX/DAPI Results"
allcsvs <-list.files(path = folder,pattern = "*.csv",full.names = TRUE,recursive = FALSE)
allcsvs<-sort(allcsvs)
#allcsvs
```


```{r}
dat<-data.frame(
  path="",
  count=0,
  label=""
)
for(i in seq(1,length(allcsvs))){
  single<-read.csv(allcsvs[i])
  name<-allcsvs[i]
  value<-grep(x = name,pattern = ".*Summary")
  if(length(value)>0){
     count<-single[1,2]
     label<-single[1,1]
  }else{
    count<-single[1,2]
    label<-single[1,1]
  }
  single$path<-name
  
  tempTable<-data.frame(
    path=name,
    count=count,
    label=label
    
  )
  
  dat<-rbind(dat,tempTable)
  
  
}
dat<-dat[-1,]
#write.xlsx(dat,"Image Analysis combined.xlsx")
```
